import{j as e,A as N,m as u}from"./framer-motion-BvSqCppS.js";import{r as m,i as y,N as g}from"./react-vendor-avSTGVV9.js";import{B as p,E as c,G as d}from"./index-z0VGOugt.js";import{r as h,K as v,C as j}from"./lucide-react-DyWIlm_Y.js";import"./firebase-Br2-H2XF.js";const x={[c.JOY]:"#FFD700",[c.PEACE]:"#87CEEB",[c.ANXIETY]:"#FF6B6B",[c.SADNESS]:"#4A90E2",[c.ANGER]:"#FF8C42"},b=t=>{if(t.length<2)return{nodes:[],links:[]};const s=Object.values(c).map(a=>({id:a,name:a,color:x[a]})),l={};for(let a=0;a<t.length-1;a++){const i=t[a].emotion,r=t[a+1].emotion;l[i]||(l[i]={}),l[i][r]=(l[i][r]||0)+1}const n=[];return Object.entries(l).forEach(([a,i])=>{Object.entries(i).forEach(([r,o])=>{o>0&&n.push({source:a,target:r,value:o})})}),{nodes:s,links:n}},w=t=>{const s=new Date().getFullYear(),l=new Date(s,0,1),n=new Date(s,11,31),a=[];for(let i=new Date(l);i<=n;i.setDate(i.getDate()+1)){const r=i.toISOString().split("T")[0],o=t.find(f=>new Date(f.date).toISOString().split("T")[0]===r);a.push({date:new Date(i),emotion:(o==null?void 0:o.emotion)||null,intensity:(o==null?void 0:o.intensity)||0})}return a},k=({timelineData:t})=>{const[s,l]=m.useState("timeline"),[n,a]=m.useState(new Date().getFullYear()),i=m.useMemo(()=>b(t),[t]),r=m.useMemo(()=>w(t),[t]);return e.jsxs("div",{className:"w-full h-full flex flex-col p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"감정 여정 시각화"}),e.jsx("p",{className:"text-sm text-slate-500",children:"나의 감정 변화를 다양한 방식으로 확인해보세요"})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs(p,{onClick:()=>l("timeline"),variant:s==="timeline"?"primary":"ghost",className:"flex-1",children:[e.jsx(h,{size:18,className:"mr-2"}),"타임라인"]}),e.jsxs(p,{onClick:()=>l("pixels"),variant:s==="pixels"?"primary":"ghost",className:"flex-1",children:[e.jsx(v,{size:18,className:"mr-2"}),"Year in Pixels"]}),e.jsxs(p,{onClick:()=>l("sankey"),variant:s==="sankey"?"primary":"ghost",className:"flex-1",children:[e.jsx(j,{size:18,className:"mr-2"}),"Sankey Flow"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:e.jsxs(N,{mode:"wait",children:[s==="timeline"&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(C,{data:t})},"timeline"),s==="pixels"&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(D,{data:r})},"pixels"),s==="sankey"&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(S,{data:i})},"sankey")]})})]})},C=({data:t})=>e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(h,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"아직 기록된 감정이 없어요"})]}):t.map((s,l)=>e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-xl bg-white/50 hover:bg-white/70 transition-colors",children:[e.jsx("div",{className:"w-4 h-4 rounded-full shrink-0 mt-1",style:{backgroundColor:x[s.emotion]}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-bold text-slate-900",children:new Date(s.date).toLocaleDateString("ko-KR",{month:"short",day:"numeric"})}),e.jsxs("span",{className:"text-xs text-slate-500",children:["강도: ",s.intensity||0,"/10"]})]}),e.jsx("p",{className:"text-sm text-slate-600",children:s.summary}),s.nuanceTags&&s.nuanceTags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:s.nuanceTags.map(n=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-brand-light text-brand-primary rounded-full",children:n},n))})]})]},s.id))})}),D=({data:t})=>{const s=m.useMemo(()=>{const l={};return t.forEach(n=>{const a=n.date.getMonth();l[a]||(l[a]=[]),l[a].push(n)}),l},[t]);return e.jsx(d,{children:e.jsx("div",{className:"space-y-6",children:Object.entries(s).map(([l,n])=>e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:[parseInt(l)+1,"월"]}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:n.map((a,i)=>e.jsx("div",{className:`
                    aspect-square rounded-sm
                    ${a.emotion?"opacity-80 hover:opacity-100 cursor-pointer transition-opacity":"bg-slate-100 opacity-30"}
                  `,style:{backgroundColor:a.emotion?x[a.emotion]:void 0},title:a.emotion?`${a.date.toLocaleDateString("ko-KR")}: ${a.emotion}`:void 0},i))})]},l))})})},S=({data:t})=>t.links.length===0?e.jsx(d,{children:e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(j,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"감정 전환 데이터가 부족해요"}),e.jsx("p",{className:"text-xs mt-2",children:"더 많은 기록을 남기면 패턴을 확인할 수 있어요"})]})}):e.jsx(d,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap gap-3 justify-center",children:t.nodes.map(s=>e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full",style:{backgroundColor:s.color+"20",border:`2px solid ${s.color}`},children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:s.color}}),e.jsx("span",{className:"text-sm font-medium text-slate-900",children:s.name})]},s.id))}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-700",children:"감정 전환 패턴"}),t.links.sort((s,l)=>l.value-s.value).map((s,l)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-white/50",children:[e.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:x[s.source]}}),e.jsx("span",{className:"text-sm text-slate-600",children:s.source}),e.jsx("div",{className:"flex-1 h-1 bg-gradient-to-r from-slate-200 to-slate-300 rounded-full relative",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${s.value/Math.max(...t.links.map(n=>n.value))*100}%`,backgroundColor:x[s.source]}})}),e.jsxs("span",{className:"text-xs font-bold text-slate-500",children:[s.value,"회"]}),e.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:x[s.target]}}),e.jsx("span",{className:"text-sm text-slate-600",children:s.target})]},l))]})]})}),A=()=>{const t=y();if(!t)return e.jsx(g,{to:"/",replace:!0});const{timelineData:s}=t;return e.jsx(k,{timelineData:s})};export{A as JournalJourney};
