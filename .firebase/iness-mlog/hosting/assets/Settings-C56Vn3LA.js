import{j as e,m as o}from"./framer-motion-BvSqCppS.js";import{d as L,r as a}from"./react-vendor-avSTGVV9.js";import{L as R,G as c,B as q}from"./index-z0VGOugt.js";import{g as B,d}from"./firestore-Dd5RvIfw.js";import{l as F,r as G,Z as T,a8 as z,_ as H}from"./lucide-react-DyWIlm_Y.js";import"./firebase-Br2-H2XF.js";const I=()=>{const S=L(),[U,m]=a.useState(!0),[x,h]=a.useState(!1),[l,u]=a.useState(!0),[j,p]=a.useState("09:00"),[b,f]=a.useState("daily"),[g,N]=a.useState("ko"),[n,v]=a.useState(!1),[i,r]=a.useState(null);a.useEffect(()=>{(async()=>{var y,w;try{m(!0);const t=await B();if(t&&(u(t.reminderEnabled??!0),p(t.reminderTime??"09:00"),f(t.reminderFrequency??"daily"),N(t.language??"ko"),v(t.predictiveNudgeEnabled??!1),t.snoozeUntil)){const D=t.snoozeUntil instanceof Date?t.snoozeUntil:((w=(y=t.snoozeUntil).toDate)==null?void 0:w.call(y))||new Date;r(D)}}catch(t){console.error("설정 불러오기 오류:",t)}finally{m(!1)}})()},[]);const k=async()=>{try{h(!0),await d({reminderEnabled:l,reminderTime:j,reminderFrequency:b,language:g,predictiveNudgeEnabled:n,snoozeUntil:i||void 0}),alert("설정이 저장되었습니다.")}catch(s){console.error("설정 저장 오류:",s),alert("설정 저장 중 오류가 발생했습니다.")}finally{h(!1)}},C=async()=>{const s=new Date;s.setHours(s.getHours()+24),r(s),await d({snoozeUntil:s}),alert("알림이 24시간 동안 일시중지되었습니다.")},E=async()=>{r(null),await d({snoozeUntil:void 0})};return U?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(R,{})}):e.jsxs("div",{className:"h-full flex flex-col p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("button",{onClick:()=>S("/profile"),className:"p-2 hover:bg-slate-100 rounded-full transition-colors","aria-label":"뒤로가기",children:"←"}),e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"설정"})]}),e.jsxs("div",{className:"space-y-4 max-w-2xl",children:[e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{size:20,className:"text-brand-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:"알림"}),e.jsx("p",{className:"text-sm text-slate-600",children:"체크인 리마인드 알림"})]})]}),e.jsx("button",{onClick:()=>u(!l),className:`
                  w-12 h-6 rounded-full transition-colors relative
                  ${l?"bg-brand-primary":"bg-slate-300"}
                `,"aria-label":l?"알림 끄기":"알림 켜기",children:e.jsx(o.div,{className:"w-5 h-5 bg-white rounded-full absolute top-0.5 shadow-sm",animate:{x:l?24:2},transition:{type:"spring",stiffness:500,damping:30}})})]}),l&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 pt-4 border-t border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{size:18,className:"text-slate-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800 text-sm",children:"알림 시간"}),e.jsx("p",{className:"text-xs text-slate-500",children:"매일 알림을 받을 시간"})]})]}),e.jsx("input",{type:"time",value:j,onChange:s=>p(s.target.value),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{size:18,className:"text-slate-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800 text-sm",children:"알림 빈도"}),e.jsx("p",{className:"text-xs text-slate-500",children:"하루에 받을 알림 횟수"})]})]}),e.jsxs("select",{value:b,onChange:s=>f(s.target.value),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white text-sm",children:[e.jsx("option",{value:"daily",children:"하루 1회"}),e.jsx("option",{value:"twice",children:"하루 2회"}),e.jsx("option",{value:"none",children:"없음"})]})]}),i&&i>new Date?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 rounded-lg border border-amber-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:16,className:"text-amber-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-900",children:"알림 일시중지 중"}),e.jsxs("p",{className:"text-xs text-amber-700",children:[i.toLocaleString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),"까지"]})]})]}),e.jsx("button",{onClick:E,className:"px-3 py-1 text-xs font-medium text-amber-700 hover:bg-amber-100 rounded-md transition-colors",children:"해제"})]}):e.jsxs("button",{onClick:C,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm text-slate-600 hover:bg-slate-50 rounded-lg border border-slate-200 transition-colors",children:[e.jsx(z,{size:16}),e.jsx("span",{children:"24시간 일시중지"})]})]})]})}),e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-1",children:"예측 넛지"}),e.jsx("p",{className:"text-sm text-slate-600 mb-2",children:"반복 패턴 시간대에 예방 코칭을 제안합니다"}),e.jsx("p",{className:"text-xs text-slate-500",children:`예: "보통 이 시간쯤 마음이 무거워지곤 하셨어요. 미리 '따뜻한 차 마시기'로 예방해볼까요?"`})]}),e.jsx("button",{onClick:()=>v(!n),className:`
                w-12 h-6 rounded-full transition-colors relative ml-4
                ${n?"bg-brand-primary":"bg-slate-300"}
              `,"aria-label":n?"예측 넛지 끄기":"예측 넛지 켜기",children:e.jsx(o.div,{className:"w-5 h-5 bg-white rounded-full absolute top-0.5 shadow-sm",animate:{x:n?24:2},transition:{type:"spring",stiffness:500,damping:30}})})]})}),e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{size:20,className:"text-brand-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:"언어"}),e.jsx("p",{className:"text-sm text-slate-600",children:"앱 언어 설정"})]})]}),e.jsxs("select",{value:g,onChange:s=>N(s.target.value),className:"px-4 py-2 rounded-lg border border-slate-200 bg-white font-medium",children:[e.jsx("option",{value:"ko",children:"한국어"}),e.jsx("option",{value:"en",children:"English"})]})]})}),e.jsx("div",{className:"pt-4",children:e.jsx(q,{onClick:k,variant:"primary",className:"w-full",disabled:x,children:x?"저장 중...":"설정 저장"})})]})]})};export{I as Settings};
