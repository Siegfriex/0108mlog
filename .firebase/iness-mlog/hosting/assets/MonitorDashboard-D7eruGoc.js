import{j as e,m as j}from"./framer-motion-DyOGlghr.js";import{r as n,i as p,N}from"./react-vendor-toRuRpSQ.js";import{p as y,T as x,q as o,E as b,L as T,G as d}from"./index-DqV5LO6N.js";import{b as I,v,N as g,$ as C}from"./lucide-react-d6c8Yrq5.js";import{R as E,L as A,C as S,X as D,Y as L,T as _,i as w}from"./recharts-CXNqbXxy.js";import"./firebase-tIcAbxpe.js";const R=({timelineData:s})=>{const[l,f]=n.useState(!0),i=n.useMemo(()=>y(),[]),m=n.useMemo(()=>s.filter(t=>(new Date().getTime()-new Date(t.date).getTime())/x.MILLISECONDS_PER_DAY<=x.DAYS_IN_WEEK).sort((t,r)=>new Date(t.date).getTime()-new Date(r.date).getTime()).map(t=>({date:new Date(t.date).toLocaleDateString("ko-KR",{month:"short",day:"numeric"}),intensity:t.intensity||0,emotion:t.emotion})),[s]),h=n.useMemo(()=>{if(s.length<o.MIN_DATA_POINTS_FOR_PATTERN)return[];const{anxietyCount:a,highIntensityCount:t}=s.reduce((c,u)=>(u.emotion===b.ANXIETY&&c.anxietyCount++,(u.intensity||0)>=o.HIGH_INTENSITY_VALUE&&c.highIntensityCount++,c),{anxietyCount:0,highIntensityCount:0}),r=[];return a>s.length*o.ANXIETY_RATIO&&r.push({type:"warning",message:"최근 불안한 감정이 자주 기록되고 있어요",icon:e.jsx(I,{size:20})}),t>s.length*o.HIGH_INTENSITY_RATIO&&r.push({type:"info",message:"강도가 높은 감정이 자주 나타나고 있어요",icon:e.jsx(v,{size:20})}),r},[s]);return n.useEffect(()=>{const a=setTimeout(()=>f(!1),x.LOADING_DELAY);return()=>clearTimeout(a)},[]),l?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(T,{})}):e.jsxs("div",{className:"w-full h-full flex flex-col p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 mb-2 flex items-center gap-2",children:[e.jsx(g,{size:28,className:"text-brand-primary"}),"실시간 모니터"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"당신의 감정 패턴을 실시간으로 추적하고 있어요"})]}),e.jsxs(d,{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"감정 추이 (최근 7일)"}),m.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(g,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"아직 충분한 데이터가 없어요"})]}):e.jsx("div",{className:"min-h-48",children:e.jsx(E,{width:"100%",height:200,children:e.jsxs(A,{data:m,children:[e.jsx(S,{strokeDasharray:"3 3",stroke:i.grid}),e.jsx(D,{dataKey:"date",stroke:i.axis,fontSize:12}),e.jsx(L,{domain:[0,10],stroke:i.axis,fontSize:12}),e.jsx(_,{contentStyle:{backgroundColor:"var(--color-glass-surface)",border:"1px solid var(--color-glass-border)",borderRadius:"var(--radius-lg)"}}),e.jsx(w,{type:"monotone",dataKey:"intensity",stroke:i.line,strokeWidth:3,dot:{r:4,fill:i.dot},activeDot:{r:6}})]})})})]}),h.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"패턴 알림"}),h.map((a,t)=>e.jsx(j.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.1},children:e.jsx(d,{className:`
                  ${a.type==="warning"?"border-orange-200 bg-orange-50/50":"border-blue-200 bg-blue-50/50"}
                `,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`
                    w-10 h-10 rounded-xl flex items-center justify-center shrink-0
                    ${a.type==="warning"?"text-orange-600 bg-orange-100":"text-blue-600 bg-blue-100"}
                  `,children:a.icon}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:a.message})]})})},t))]}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center text-purple-600 shrink-0",children:e.jsx(C,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-2",children:"오늘의 인사이트"}),e.jsx("p",{className:"text-sm text-slate-600",children:s.length>0?`지금까지 ${s.length}개의 감정 기록을 남기셨네요. 계속 기록하면 더 정확한 패턴을 발견할 수 있어요.`:"감정을 기록하기 시작하면 인사이트를 제공해드릴게요."})]})]})})]})},H=()=>{const s=p();if(!s)return e.jsx(N,{to:"/",replace:!0});const{timelineData:l}=s;return e.jsx(R,{timelineData:l})};export{H as MonitorDashboardPage};
